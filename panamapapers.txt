PANAMA PAPERS


 - Question 1) Combien la base de donn√©es contient-elle de soci√©t√©s offshores diff√©rentes dont la source est "Panama Papers" ?
SELECT COUNT (DISTINCT name) 
FROM entity 
WHERE source ='Panama Papers' AND entity.name IS NOT NULL

 - Question 2) Quel interm√©diaire a cr√©√© le plus de soci√©t√©s offshores ? A-t-on son adresse et son pays ?
SELECT entity.name, intermediary.name, address.address, address.country_codes,
count(*) as nb_int
FROM entity, intermediary, address
WHERE entity.id_address = intermediary.id_address and intermediary.id_address = address.id_address
GROUP BY intermediary.name
ORDER BY nb_int DESC
LIMIT 3

 - Question 3) a)Combien la base contient-elle de b√©n√©ficiaires avec un nom unique ? b)Quel est le b√©n√©ficiaire dont le nom revient le plus souvent ?
a) Combien la base contient-elle de b√©n√©ficiaires avec un nom unique ?
SELECT COUNT (DISTINCT name) 
FROM officer;
b) Quel est le b√©n√©ficiaire dont le nom revient le plus souvent ?
SELECT officer.name,
count(*) as nb_name
FROM officer
GROUP BY officer.name
ORDER BY nb_name DESC
LIMIT 3

 - Question 4) Donner la liste des juridictions avec le nombre d'entreprises offshores enregistr√©es sur chaque territoire, tri√©e par ordre d√©croissant.
SELECT entity.jurisdiction_description,
count(*) as nb_name
FROM entity
GROUP BY entity.jurisdiction_description
ORDER BY nb_name DESC
LIMIT 15

 - Question 5) Regrouper les soci√©t√©s offshores par statut, et trier la liste par ordre d√©croissant.
SELECT entity.status, entity.name
FROM entity
ORDER BY entity.status, entity.name DESC,

 - Question 6) Trouver la liste des b√©n√©ficiaires dont le nom contient "BNP" et ajouter, pour chaque b√©n√©ficiaire, le nom des soci√©t√©s offshores.
SELECT officer.name, entity.name 
FROM officer, assoc_officer_entity, entity  
WHERE officer.id = assoc_officer_entity.officer AND assoc_officer_entity.entity = entity.id AND officer.name LIKE '%BNP%';

 - Question 7) Trouver la liste des soci√©t√©s dont la juridiction est "France", "Monaco" ou "R√©union".
SELECT * 
FROM entity 
WHERE entity.jurisdiction_description 
LIKE '%Monaco%' OR entity.jurisdiction_description LIKE '%Reunion%' OR entity.jurisdiction_description LIKE '%Reunion%';

 - Question 8) Trouver la liste des soci√©t√©s dont le pays de l'adresse et le pays de la juridiction sont diff√©rents.
 - Question 9) Trouver la liste des b√©n√©ficiaires qui ont des soci√©t√©s au m√™me nom et enregistr√©e √† la m√™me date, trier la liste par odre d√©croissant.
 - Question 10) Donner la liste des interm√©diaires qui ont aussi √©t√© b√©n√©ficiaires, en ajoutant leur nom de b√©n√©ficiaire et leur adresse.
 - Question 12) Donner le top 10 des b√©n√©ficiaires qui ont le plus d'identit√©s diff√©rentes (similar name and address) et le nombre d'identit√©s correspondant.
 - Question 13) Donner le top 10 des b√©n√©ficiaires qui ont le plus de parts toujours valides dans des entreprises offshores (dont la date de fin n'est pas encore pass√©e).
 - Question 14) Question bonus : r√©ussir √† retrouver dans la base au moins 3 personnalit√©s que tu connais (indice) üòéüòéüòé